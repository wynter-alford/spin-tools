clear;Iz = 0.5*[1 0; 0 -1];Ix = 0.5*[0 1; 1 0];Iy = 0.5*[0 -1i; 1i 0];Id = eye(2);N = 6;dim = 2^N;nqc = 0:1:N;%d = zeros(N,N);d = diag(ones(N-1,1),1) + diag(ones(N-1,1),-1);%for kk = 1:N,%   d = d + diag(ones(N-kk,1)/kk^3,kk) + diag(ones(N-kk,1)/kk^3,-kk);%end%da =     [0       -0.7/4    0.7/8    -0.5   0.7/8   -0.7/4    -1/16;%         -0.7/4     0       0.7/8    -0.5   0.7/8   -1/16   -0.7/4;%         0.7/8    0.7/8       0       1      1/8    0.7/8    0.7/8;%	 -0.5     -0.5        1       0      1      -0.5     -0.5;%	 0.7/8    0.7/8      1/8      1      0      0.7/8    0.7/8;%	 -0.7/4   -1/16     0.7/8   -0.5   0.7/8     0     -0.7/4;%	 -1/16    -0.7/4    0.7/8   -0.5   0.7/8   -0.7/4    0  ];%db =     [0     1     0     0     0     0     0;%         1     0     1     0     0     0     0;%         0     1     0     1     0     0     0;%	 0     0     1     0     1     0     0;%	 0     0     0     1     0     1     0;%	 0     0     0     0     1     0     1;%	 0     0     0     0     0     1     0];%dc =     [0        1       1/2^3     1/3^3    1/4^3     1/5^3     1/6^3;%          1        0       1         1/2^3    1/3^3     1/4^3     1/5^3;%          1/2^3    1       0         1        1/2^3     1/3^3     1/4^3;%	  1/3^3    1/2^3   1         0        1         1/2^3     1/3^3;%	  1/4^3    1/3^3   1/2^3     1        0         1         1/2^3;%	  1/5^3    1/4^3   1/3^3     1/2^3    1         0         1;%	  1/6^3    1/5^3   1/4^3     1/3^3    1/2^3     1         0];HDQ = sparse(dim,dim);Y = sparse(dim,dim);%Hdip = sparse(dim,dim); for ii = 1:N    Y = Y + mykron(speye(2^(ii-1)),Iy,speye(2^(N-ii)));       for jj = ii+1:N    HDQ = HDQ + d(ii,jj)*(mykron(speye(2^(ii-1)),Ix,speye(2^(jj-ii-1)),Ix,speye(2^(N-jj))) - mykron(speye(2^(ii-1)),Iy,speye(2^(jj-ii-1)),Iy,speye(2^(N-jj))));    endendrho1 = mykron(speye(4),Iz,speye(2^(N-3)));delta = 5e-1;U1 = sparse(expms(-1i*HDQ*delta));U2 = sparse(expms(-1i*(pi/2)*Y));%for n = 1:20,%rho1 = U1*rho1*U1';%endfor n = 1:20rho1 = U1*rho1*U1';[coeff, basis] = getPO(rho1,0.05);coeff = real(coeff);mq = getMQC(rho1);subplot(1,2,1), plot(nqc,mq); hold on;rho2 = U2*rho1*U2';mq2 = getMQC(rho2);subplot(1,2,2), plot(nqc,mq2); hold on;%fname = strcat('N6c_',int2str(n));%save(fname, 'n', 'coeff', 'basis');end